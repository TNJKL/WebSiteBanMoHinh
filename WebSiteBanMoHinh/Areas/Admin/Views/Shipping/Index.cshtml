@model ShippingModel
@{
    ViewData["title"] = "Create Shipping";
}


<style>
    :root {
        --primary-color: rgb(216,172,68); /* Màu vàng đậm giống anime */
        --secondary-color: rgb(255,204,102); /* Màu vàng nhạt */
        --text-color: rgb(50,50,50);
        --gold-color: #DAA520; /* Màu vàng kim loại */
    }

    h4, h2 {
        color: var(--primary-color) !important;
        font-weight: 900 !important;
        margin-bottom: 20px !important;
        text-align: center !important;
        font-size: 2rem !important;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.1); /* Hiệu ứng bóng nhẹ */
    }

    .add-product-container, .table-container {
        background: #fff !important;
        border-radius: 10px !important;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1) !important;
        padding: 20px !important;
        margin: 20px auto !important;
        max-width: 800px !important; /* Tăng chiều rộng cho đẹp hơn */
    }

        .add-product-container .form-group {
            margin-bottom: 20px !important;
            text-align: center !important;
        }

            .add-product-container .form-group label {
                color: var(--text-color) !important;
                font-weight: 700 !important;
                font-size: 1.1rem !important;
                display: block !important;
                margin-bottom: 5px !important;
            }

            .add-product-container .form-group select,
            .add-product-container .form-group input {
                width: 60% !important; /* Giảm chiều rộng để gọn hơn */
                max-width: 300px !important;
                padding: 10px !important;
                border: 1px solid var(--gold-color) !important;
                border-radius: 5px !important;
                font-size: 1rem !important;
                color: var(--text-color) !important;
                transition: all 0.3s ease !important;
                margin: 0 auto !important;
                display: block !important;
            }

                .add-product-container .form-group select:focus,
                .add-product-container .form-group input:focus {
                    border-color: var(--primary-color) !important;
                    box-shadow: 0 0 5px rgba(216,172,68,0.3) !important;
                    outline: none !important;
                }

    .text-danger {
        color: #dc3545 !important;
        font-size: 0.9rem !important;
        margin-top: 5px !important;
        display: block !important;
        text-align: center !important;
    }

    .btn-primary {
        background: linear-gradient(to right, var(--primary-color), var(--secondary-color)) !important;
        border: none !important;
        color: #fff !important;
        padding: 10px 20px !important;
        border-radius: 5px !important;
        font-size: 1rem !important;
        font-weight: 700 !important;
        transition: all 0.3s ease !important;
        display: inline-block !important;
    }

        .btn-primary:hover {
            background: linear-gradient(to right, var(--secondary-color), var(--primary-color)) !important;
            transform: translateY(-2px) !important;
        }

    .table-container .table {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        color: var(--text-color) !important;
    }

        .table-container .table thead {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color)) !important;
            color: #fff !important;
        }

        .table-container .table th, .table-container .table td {
            padding: 8px 10px !important;
            text-align: center !important;
            border-bottom: 1px solid rgba(0,0,0,0.1) !important;
            vertical-align: middle !important;
        }

        .table-container .table th {
            font-weight: 900 !important;
            font-size: 1.1rem !important;
        }

        .table-container .table td {
            font-size: 0.9rem !important;
        }

        .table-container .table tbody tr:hover {
            background: rgba(216,172,68,0.1) !important;
            transition: all 0.3s ease !important;
        }

    .btn-danger {
        background: #dc3545 !important;
        border: none !important;
        color: #fff !important;
        transition: all 0.3s ease !important;
        padding: 4px 8px !important;
        border-radius: 5px !important;
        font-size: 0.75rem !important;
    }

        .btn-danger:hover {
            background: #c82333 !important;
            transform: translateY(-2px) !important;
        }

    .back-link {
        display: inline-block !important;
        margin-top: 20px !important;
        color: var(--primary-color) !important;
        font-weight: 700 !important;
        font-size: 1rem !important;
        text-decoration: none !important;
        transition: all 0.3s ease !important;
        text-align: center !important;
        width: 100% !important;
    }

        .back-link:hover {
            color: var(--gold-color) !important;
            text-decoration: underline !important;
        }

    /* Media queries để điều chỉnh trên màn hình nhỏ */
    @@media (max-width: 768px) {
        h4, h2 {
            font-size: 1.5rem !important;
        }

        .add-product-container, .table-container {
            padding: 15px !important;
            margin: 10px !important;
        }

            .add-product-container .form-group select,
            .add-product-container .form-group input {
                width: 80% !important;
                padding: 8px !important;
                font-size: 0.9rem !important;
            }

        .btn-primary {
            padding: 8px 16px !important;
            font-size: 0.9rem !important;
        }

        .table-container .table th {
            font-size: 0.9rem !important;
        }

        .table-container .table td {
            font-size: 0.8rem !important;
        }

        .btn-danger {
            padding: 3px 6px !important;
            font-size: 0.65rem !important;
        }

        .back-link {
            font-size: 0.9rem !important;
        }
    }
</style>

<div class="add-product-container">
    <h4>Create Shipping</h4>
    <div>
        <div asp-validation-summary="ModelOnly" class="text-danger"></div>

        <div class="form-group">
            <label>Tỉnh thành phố</label>
            <select class="css_select" id="tinh" name="tinh" title="Chọn Tỉnh Thành">
                <option value="0">Tỉnh Thành</option>
            </select>
        </div>

        <div class="form-group">
            <label>Quận huyện</label>
            <select class="css_select" id="quan" name="quan" title="Chọn Quận Huyện">
                <option value="0">Quận Huyện</option>
            </select>
        </div>

        <div class="form-group">
            <label>Phường xã</label>
            <select class="css_select" id="phuong" name="phuong" title="Chọn Phường Xã">
                <option value="0">Phường Xã</option>
            </select>
        </div>

        <div class="form-group">
            <label>Giá</label>
            <input asp-for="Price" id="price-shipping" class="form-control" />
        </div>

        <div class="form-group">
            <button type="button" class="btn btn-primary btn-add-shipping">Add</button>
        </div>
    </div>
</div>

<div class="table-container">
    <h2>Shipping List</h2>
    <table class="table" id="myTable">
        <thead>
            <tr>
                <th>City</th>
                <th>District</th>
                <th>Ward</th>
                <th>Price</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var shipping in ViewBag.Shippings)
            {
                <tr>
                    <td>@shipping.City</td>
                    <td>@shipping.District</td>
                    <td>@shipping.Ward</td>
                    <td>@shipping.Price.ToString("#,##0 VNĐ")</td>
                    <td>
                        <a onclick="return confirm('Bạn có muốn xóa Shipping?')" href="@Url.Action("Delete", "Shipping", new { id = shipping.Id })" class="btn btn-danger">Delete</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
    <a asp-action="Index" asp-controller="Shipping" class="back-link">Back to list shippings</a>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    <script>
        $(".btn-add-shipping").click(function(){
            var tinh = $("#tinh").find('option:selected').text();
            var quan = $("#quan").find('option:selected').text();
            var phuong = $("#phuong").find('option:selected').text();
            var price = $("#price-shipping").val();
            if (tinh == '' || quan == '' || phuong == '' || price == '') {
                Swal.fire("Vui lòng không bỏ trống.");
            } else {
                $.ajax({
                    type: "POST",
                    url: "@Url.Action("StoreShipping", "Shipping")",
                    data: { tinh: tinh, quan: quan, phuong: phuong, price: price },
                    success: function (result) {
                        if (result.success) {
                            Swal.fire("Thêm vận chuyển thành công. Load lại page để thấy data.");
                        } else if (result.duplicate) {
                            Swal.fire("Dữ liệu trùng lặp.");
                        }
                    }
                });
            }
        });

        $(document).ready(function() {
            $.getJSON('https://esgoo.net/api-tinhthanh/1/0.htm', function(data_tinh){
                if(data_tinh.error == 0){
                    $.each(data_tinh.data, function (key_tinh, val_tinh) {
                        $("#tinh").append('<option value="'+val_tinh.id+'">'+val_tinh.full_name+'</option>');
                    });
                    $("#tinh").change(function(e){
                        var idtinh = $(this).val();
                        $.getJSON('https://esgoo.net/api-tinhthanh/2/'+idtinh+'.htm', function(data_quan){
                            if(data_quan.error == 0){
                                $("#quan").html('<option value="0">Quận Huyện</option>');
                                $("#phuong").html('<option value="0">Phường Xã</option>');
                                $.each(data_quan.data, function (key_quan, val_quan) {
                                    $("#quan").append('<option value="'+val_quan.id+'">'+val_quan.full_name+'</option>');
                                });
                                $("#quan").change(function(e){
                                    var idquan = $(this).val();
                                    $.getJSON('https://esgoo.net/api-tinhthanh/3/'+idquan+'.htm', function(data_phuong){
                                        if(data_phuong.error == 0){
                                            $("#phuong").html('<option value="0">Phường Xã</option>');
                                            $.each(data_phuong.data, function (key_phuong, val_phuong) {
                                                $("#phuong").append('<option value="'+val_phuong.id+'">'+val_phuong.full_name+'</option>');
                                            });
                                        }
                                    });
                                });
                            }
                        });
                    });
                }
            });
        });
    </script>
}

